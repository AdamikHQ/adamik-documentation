---
icon: arrow-progress
title: Babylon BTC Staking using the Adamik API
---

## Overview

Babylon allows Bitcoin holders to participate in staking, earning rewards while maintaining their BTC holdings. This guide walks through the process of staking Bitcoin using the Adamik API, including transaction creation, signing, and broadcasting.

> üìå **Important Notes**
>
> - Babylon offers two registration methods: **pre-stake** and post-stake. This guide implements the user-friendly **pre-stake registration** flow. See [Bitcoin Stake Registration Methods](https://github.com/babylonlabs-io/babylon/blob/main/docs/register-bitcoin-stake.md#2-bitcoin-stake-registration-methods) for details.
> - Babylon is currently only available on Bitcoin Signet network for testing. When Babylon launches on Bitcoin mainnet, simply replace `"bitcoin-signet"` with `"bitcoin"` in API calls.
> - The example data shown is for demonstration purposes. While encoded payloads are valid for signing, they may not match the provided examples exactly.

![Babylon API Pre-Registration Flow](/images/BABYLON-API-FLOWS-pre-reg.png)

## Staking Process

### 1. Collect Required Information

#### Retrieve Babylon Validators

First, fetch the list of available Babylon "finality providers" (validators):

<CodeGroup>
```http GET Request
GET /api/babylon/validators
```

```json Response
{
  "chainId": "babylon",
  "validators": [...]
}
```

</CodeGroup>

#### User Inputs

You'll need to collect:

- **From UI**: Chosen validator and staking amount
- **From user data**: Bitcoin address and Bitcoin public key (**NOT** the xpub)

### 2. Create Bitcoin Staking Transaction

Generate the Bitcoin transaction payloads for signing:

<CodeGroup>
```json Request
POST /api/bitcoin-signet/transaction/encode
{
  "transaction": {
    "data": {
      "mode": "stake",
      "senderAddress": "tb1pwj4q5jhwlszj6rnrahd95huu6j56dvj9ltfnag55prqnpc53vpqsxh76tx",
      "senderPubKey": "02bd2eb288281a9e7a15ec81b8b593f243b96fbcd2b16a1a509c1b87df95fc499c",
      "targetValidatorAddress": "ee9da95e9fecbb2191943c56a109d1dc81787a77994ad9ef89278850a58e4876",
      "amount": "1000"
    }
  }
}
```

```json Response
{
  "chainId": "bitcoin-signet",
  "transaction": {
    "data": {
      "mode": "stake",
      "senderAddress": "tb1pwj4q5jhwlszj6rnrahd95huu6j56dvj9ltfnag55prqnpc53vpqsxh76tx",
      "senderPubKey": "02bd2eb288281a9e7a15ec81b8b593f243b96fbcd2b16a1a509c1b87df95fc499c",
      "targetValidatorAddress": "ee9da95e9fecbb2191943c56a109d1dc81787a77994ad9ef89278850a58e4876",
      "amount": "1000",
      "fees": "1896",
      "params": {
        "stakingPsbt": "xxx",
        "slashingPsbt": "xxx",
        "unbondingSlashingPsbt": "xxx",
        "unbondingPsbt": "xxx"
      }
    },
    "encoded": "xxx" // (stakingPsbt, duplicated for convenience and consistency)
  },
  "status": {
    "errors": [],
    "warnings": []
  }
}
```

</CodeGroup>

### 3. Sign Bitcoin Transactions

Sign the following payloads with a compatible Bitcoin signer:

- **Staking PSBT**: The main transaction for staking
- **Slashing PSBT**: Required for the slashing mechanism
- **Unbonding Slashing PSBT**: For slashing during unbonding
- **Babylon Address**: Sign with Bitcoin signer: `[ECDSA or BIP322](hex(bech32Address))`

> ‚ìò The unbonding PSBT does not need to be signed at this stage, but must be included in the registration call.

### 4. Register with Babylon Blockchain

Create the Babylon **registration** transaction:

<CodeGroup>
```json Request
POST /api/babylon/transaction/encode
{
  "transaction": {
    "data": {
      "mode": "registerStake",
      // User's Bitcoin public key in hexadecimal format
      "senderPubKey": "xxxxxxxxxxxxxxxxxx",
      // User's Babylon address
      "senderAddress": "xxxxxxxxxxxxxxxxxx",
      // User's Babylon address, signed with Bitcoin signer (hex)
      "proofOfPossession": "xxxxxxxxxxxxxxxxxx",
      "amount": "1234",
      // Bitcoin finality provider's public key (hex)
      "validatorPubKey": "xxxxxxxxxxxxxxxxxx",
      // The unbonding PSBT, exactly as provided in the response of the Bitcoin encode
      "unbondingPsbt": "xxxxxxxxxxxxxxxxxx",
      // Staking transaction, signed from the provided PSBT (hex)
      "signedStakingTransaction": "xxxxxxxxxxxxxxxxxx",
      // Slashing transaction, signed from the provided PSBT (hex)
      "signedSlashingTransaction": "xxxxxxxxxxxxxxxxxx",
      // Unbonding slashing transaction, signed from the provided PSBT (hex)
      "signedUnbondingSlashingTransaction": "xxxxxxxxxxxxxxxxxx"
    }
  }
}
```

```json Response
{
  "chainId": "babylon",
  "transaction": {
    "data": {
      "mode": "registerStake",
      "senderPubKey": "xxxxxxxxxxxxxxxxxx",
      "senderAddress": "xxxxxxxxxxxxxxxxxx",
      "proofOfPossession": "xxxxxxxxxxxxxxxxxx",
      "amount": "1234",
      "validatorPubKey": "xxxxxxxxxxxxxxxxxx",
      "unbondingPsbt": "xxxxxxxxxxxxxxxxxx",
      "signedStakingTransaction": "xxxxxxxxxxxxxxxxxx",
      "signedSlashingTransaction": "xxxxxxxxxxxxxxxxxx",
      "signedUnbondingSlashingTransaction": "xxxxxxxxxxxxxxxxxx",
      "fees": "12432",
      "gas": "1775858"
    },
    "encoded": "0a330a310a2d2f626162796c6f6e2e6274637374616b696e672e76312e4d736743726561746542544344656c65676174696f6e120012650a500a460a1f2f636f736d6f732e63727970746f2e736563703235366b312e5075624b657912230a2103833d5aebe72ca68e3816c4a466d395280929f07ccf5e75dc4e2d71c2c92da45812040a020801180712110a0b0a047562626e120337303010a08d061a0a62626e2d746573742d3520eac404"
  },
  "status": {
    "errors": [],
    "warnings": []
  }
}
```

</CodeGroup>

> ‚ÑπÔ∏è The returned encoded transaction is in Cosmos' protobuf format, serialized as hex.

### 5. Sign Babylon Transaction

Sign the encoded Babylon transaction using a Babylon-compatible wallet.

### 6. Broadcast Babylon Registration Transaction

<CodeGroup>
```json Request
POST /api/babylon/transaction/broadcast
{
  "chainId": "babylon",
  "transaction": {
    "data": {
      "mode": "registerStake",
      "senderPubKey": "xxxxxxxxxxxxxxxxxx",
      "senderAddress": "xxxxxxxxxxxxxxxxxx",
      "proofOfPossession": "xxxxxxxxxxxxxxxxxx",
      "amount": "1234",
      "validatorPubKey": "xxxxxxxxxxxxxxxxxx",
      "unbondingPsbt": "xxxxxxxxxxxxxxxxxx",
      "signedStakingTransaction": "xxxxxxxxxxxxxxxxxx",
      "signedSlashingTransaction": "xxxxxxxxxxxxxxxxxx",
      "signedUnbondingSlashingTransaction": "xxxxxxxxxxxxxxxxxx",
      "fees": "12432",
      "gas": "1775858"
    },
    "encoded": "0a330a310a2d2f626162796c6f6e2e6274637374616b696e672e76312e4d736743726561746542544344656c65676174696f6e120012650a500a460a1f2f636f736d6f732e63727970746f2e736563703235366b312e5075624b657912230a2103833d5aebe72ca68e3816c4a466d395280929f07ccf5e75dc4e2d71c2c92da45812040a020801180712110a0b0a047562626e120337303010a08d061a0a62626e2d746573742d3520eac404",
    "signature": "xxxxxxxxxxxxxxxxxx"
  }
}
```

```json Response
{
  "chainId": "babylon",
  "hash": "E66FD5957527263056AB39308DA9D5AAB984AF25D38067248156339C7DDE9899"
}
```

</CodeGroup>

### 7. Wait for Confirmation

Monitor the transaction status until it's confirmed:

<CodeGroup>
```http GET Request
GET /api/babylon/transaction/{hash}
```

```json Response
{
  "transaction": {
    "parsed": {
      "id": "C5D2C6EF1092369AD9F7D8302C5F2AADDED7CC9EB43BF445D0E33D3C6A957FA3",
      "mode": "unknown",
      "state": "confirmed",
      "blockHeight": "288089",
      "timestamp": "1739465632000",
      "fees": {
        "amount": "12397",
        "ticker": "ubbn"
      },
      "gas": "1770929"
    }
  },
  "status": {
    "errors": [],
    "warnings": []
  }
}
```

</CodeGroup>

> ‚ö†Ô∏è **Important**: Wait for `transaction.parsed.state` to be `confirmed` before proceeding to the next step.

### 8. Broadcast Bitcoin Staking Transaction

Once the Babylon registration is confirmed, broadcast the signed Bitcoin staking transaction:

<CodeGroup>
```json Request
POST /api/bitcoin-signet/transaction/broadcast
{
  "chainId": "bitcoin-signet",
  "transaction": {
    "data": {
      "mode": "stake",
      "senderAddress": "tb1pwj4q5jhwlszj6rnrahd95huu6j56dvj9ltfnag55prqnpc53vpqsxh76tx",
      "senderPubKey": "02bd2eb288281a9e7a15ec81b8b593f243b96fbcd2b16a1a509c1b87df95fc499c",
      "targetValidatorAddress": "ee9da95e9fecbb2191943c56a109d1dc81787a77994ad9ef89278850a58e4876",
      "amount": "1000",
      "fees": "1896"
    },
    "encoded": "70736274ff010089020000000144a549ead63ac9c6987b90669208ece5e93f28de4b1f97b5e4036c995f47b3d50100000000ffffffff0250c3000000000000225120a80fe5278c52cab2e0a0c9702713f61fe8f2f248346a6d7dcc1245338c14ec1609dd06000000000022512074aa0a4aeefc052d0e63edda5a5f9cd4a9a6b245fad33ea29408c130e2916041000000000001012b31a507000000000022512074aa0a4aeefc052d0e63edda5a5f9cd4a9a6b245fad33ea29408c130e2916041011720bd2eb288281a9e7a15ec81b8b593f243b96fbcd2b16a1a509c1b87df95fc499c000000",
    "signature": "xxxxxxxxxxxxxxxxxx"
  }
}
```

```json Response
{
  "chainId": "bitcoin-signet",
  "hash": "5a2d155884d3021f5c9a9437d6b9411003a8c7fdc6d94d47c9e9723d82a9353a"
}
```

</CodeGroup>

## Managing Staking Positions

### View Bitcoin Staking Positions

Retrieve all staking positions for a Bitcoin public key:

<CodeGroup>
```http GET Request
GET /api/bitcoin-signet/account/state/{public_key}?include=staking
```

```json Response
{
  "chainId": "bitcoin-signet",
  "accountId": "02bd2eb288281a9e7a15ec81b8b593f243b96fbcd2b16a1a509c1b87df95fc499c",
  "balances": {
    "staking": {
      "total": "80000",
      "locked": "50000",
      "unlocking": "20000",
      "unlocked": "10000",
      "positions": [
        {
          "stakeId": "52bfb146f0f8c8b98b0fa584056dfb75658b078aac04f3c5a641db9df297387b",
          "validatorAddresses": [
            "d23c2c25e1fcf8fd1c21b9a402c19e2e309e531e45e92fb1e9805b6056b0cc76"
          ],
          "amount": "50000",
          "status": "locked",
          "completionDate": "1738746956000"
        },
        {
          "stakeId": "d5b3475f996c03e4b5971f4bde283fe9e5ec089266907b98c6c93ad6ea49a544",
          "validatorAddresses": [
            "d23c2c25e1fcf8fd1c21b9a402c19e2e309e531e45e92fb1e9805b6056b0cc76"
          ],
          "amount": "20000",
          "status": "unlocking",
          "completionDate": "1738746956000"
        },
        {
          "stakeId": "943b38b6e1d6ffe0194f93dbfbe36499d1eaa625867aae17a59aff2825d42109",
          "validatorAddresses": [
            "143a1961c97682d59b5f48d5b469ac74ac45273245947865e3c4ad575e4fa646"
          ],
          "amount": "10000",
          "status": "unlocked"
        }
      ],
      // Rewards unsupported yet, will come at a later step
      "rewards": {
        "native": [],
        "tokens": []
      }
    }
  }
}
```

</CodeGroup>

## Coming Soon Features

### Unbonding

The unbonding process for Babylon staking will be documented soon.

### Withdraw

The withdrawal process for Babylon staking will be documented soon.

### Claim Rewards

The reward claiming process for Babylon staking will be documented soon.
